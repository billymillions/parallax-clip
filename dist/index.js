(()=>{var ba=Object.defineProperty,oa=Object.prototype.hasOwnProperty,Fa=(m,n)=>()=>(n||(n={exports:{}},m(n.exports,n)),n.exports),Ga=m=>ba(m,"__esModule",{value:!0}),Ha=(m,n)=>{Ga(m);if(typeof n==="object"||typeof n==="function")for(let k in n)oa.call(n,k)&&!oa.call(m,k)&&k!=="default"&&ba(m,k,{get:()=>n[k],enumerable:!0});return m},Ia=m=>m&&m.__esModule?m:Ha(ba({},"default",{value:m,enumerable:!0}),m);var ia=Fa((m,n)=>{(function(k,v){typeof m==="object"&&typeof n!=="undefined"?n.exports=v():typeof define==="function"&&define.amd?define(v):(k=k||self,k.polygonClipping=v())})(m,function(){"use strict";function k(g,d){if(!(g instanceof d))throw new TypeError("Cannot call a class as a function")}function v(g,d){for(var a=0;a<d.length;a++){var b=d[a];b.enumerable=b.enumerable||!1,b.configurable=!0,"value"in b&&(b.writable=!0),Object.defineProperty(g,b.key,b)}}function s(g,d,a){return d&&v(g.prototype,d),a&&v(g,a),g}var w=function g(d,a){k(this,g),this.next=null,this.key=d,this.data=a,this.left=null,this.right=null};function K(g,d){return g>d?1:g<d?-1:0}function B(g,d,a){for(var b=new w(null,null),c=b,e=b;;){var f=a(g,d.key);if(f<0){if(d.left===null)break;if(a(g,d.left.key)<0){var i=d.left;d.left=i.right,i.right=d,d=i;if(d.left===null)break}e.left=d,e=d,d=d.left}else if(f>0){if(d.right===null)break;if(a(g,d.right.key)>0){var h=d.right;d.right=h.left,h.left=d,d=h;if(d.right===null)break}c.right=d,c=d,d=d.right}else break}return c.right=d.left,e.left=d.right,d.left=b.right,d.right=b.left,d}function x(g,d,a,b){var c=new w(g,d);if(a===null)return c.left=c.right=null,c;a=B(g,a,b);var e=b(g,a.key);return e<0?(c.left=a.left,c.right=a,a.left=null):e>=0&&(c.right=a.right,c.left=a,a.right=null),c}function P(g,d,a){var b=null,c=null;if(d){d=B(g,d,a);var e=a(d.key,g);e===0?(b=d.left,c=d.right):e<0?(c=d.right,d.right=null,b=d):(b=d.left,d.left=null,c=d)}return{left:b,right:c}}function Y(g,d,a){return d===null?g:g===null?d:(d=B(g.key,d,a),d.left=g,d)}function H(g,d,a,b,c){if(g){b("".concat(d).concat(a?"└── ":"├── ").concat(c(g),`
`));var e=d+(a?"    ":"│   ");g.left&&H(g.left,e,!1,b,c),g.right&&H(g.right,e,!0,b,c)}}var I=function(){function g(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:K;k(this,g),this._root=null,this._size=0,this._comparator=d}return s(g,[{key:"insert",value:function d(a,b){return this._size++,this._root=x(a,b,this._root,this._comparator)}},{key:"add",value:function d(a,b){var c=new w(a,b);this._root===null&&(c.left=c.right=null,this._size++,this._root=c);var e=this._comparator,f=B(a,this._root,e),i=e(a,f.key);return i===0?this._root=f:(i<0?(c.left=f.left,c.right=f,f.left=null):i>0&&(c.right=f.right,c.left=f,f.right=null),this._size++,this._root=c),this._root}},{key:"remove",value:function d(a){this._root=this._remove(a,this._root,this._comparator)}},{key:"_remove",value:function d(a,b,c){var e;if(b===null)return null;b=B(a,b,c);var f=c(a,b.key);return f===0?(b.left===null?e=b.right:(e=B(a,b.left,c),e.right=b.right),this._size--,e):b}},{key:"pop",value:function d(){var a=this._root;if(a){for(;a.left;)a=a.left;return this._root=B(a.key,this._root,this._comparator),this._root=this._remove(a.key,this._root,this._comparator),{key:a.key,data:a.data}}return null}},{key:"findStatic",value:function d(a){for(var b=this._root,c=this._comparator;b;){var e=c(a,b.key);if(e===0)return b;e<0?b=b.left:b=b.right}return null}},{key:"find",value:function d(a){if(this._root){this._root=B(a,this._root,this._comparator);if(this._comparator(a,this._root.key)!==0)return null}return this._root}},{key:"contains",value:function d(a){for(var b=this._root,c=this._comparator;b;){var e=c(a,b.key);if(e===0)return!0;e<0?b=b.left:b=b.right}return!1}},{key:"forEach",value:function d(a,b){for(var c=this._root,e=[],f=!1;!f;)c!==null?(e.push(c),c=c.left):e.length!==0?(c=e.pop(),a.call(b,c),c=c.right):f=!0;return this}},{key:"range",value:function d(a,b,c,e){for(var f=[],i=this._comparator,h=this._root,j;f.length!==0||h;)if(h)f.push(h),h=h.left;else{h=f.pop(),j=i(h.key,b);if(j>0)break;if(i(h.key,a)>=0){if(c.call(e,h))return this}h=h.right}return this}},{key:"keys",value:function d(){var a=[];return this.forEach(function(b){var c=b.key;return a.push(c)}),a}},{key:"values",value:function d(){var a=[];return this.forEach(function(b){var c=b.data;return a.push(c)}),a}},{key:"min",value:function d(){return this._root?this.minNode(this._root).key:null}},{key:"max",value:function d(){return this._root?this.maxNode(this._root).key:null}},{key:"minNode",value:function d(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._root;if(a)for(;a.left;)a=a.left;return a}},{key:"maxNode",value:function d(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this._root;if(a)for(;a.right;)a=a.right;return a}},{key:"at",value:function d(a){for(var b=this._root,c=!1,e=0,f=[];!c;)if(b)f.push(b),b=b.left;else if(f.length>0){b=f.pop();if(e===a)return b;e++,b=b.right}else c=!0;return null}},{key:"next",value:function d(a){var b=this._root,c=null;if(a.right){for(c=a.right;c.left;)c=c.left;return c}for(var e=this._comparator;b;){var f=e(a.key,b.key);if(f===0)break;f<0?(c=b,b=b.left):b=b.right}return c}},{key:"prev",value:function d(a){var b=this._root,c=null;if(a.left!==null){for(c=a.left;c.right;)c=c.right;return c}for(var e=this._comparator;b;){var f=e(a.key,b.key);if(f===0)break;f<0?b=b.left:(c=b,b=b.right)}return c}},{key:"clear",value:function d(){return this._root=null,this._size=0,this}},{key:"toList",value:function d(){return Ja(this._root)}},{key:"load",value:function d(a){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,e=a.length,f=this._comparator;c&&da(a,b,0,e-1,f);if(this._root===null)this._root=L(a,b,0,e),this._size=e;else{var i=Ka(this.toList(),Q(a,b),f);e=this._size+e,this._root=ca({head:i},0,e)}return this}},{key:"isEmpty",value:function d(){return this._root===null}},{key:"toString",value:function d(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(c){return String(c.key)},b=[];return H(this._root,"",!0,function(c){return b.push(c)},a),b.join("")}},{key:"update",value:function d(a,b,c){var e=this._comparator,f=P(a,this._root,e),i=f.left,h=f.right;e(a,b)<0?h=x(b,c,h,e):i=x(b,c,i,e),this._root=Y(i,h,e)}},{key:"split",value:function d(a){return P(a,this._root,this._comparator)}},{key:"size",get:function d(){return this._size}},{key:"root",get:function d(){return this._root}}]),g}();function L(g,d,a,b){var c=b-a;if(c>0){var e=a+Math.floor(c/2),f=g[e],i=d[e],h=new w(f,i);return h.left=L(g,d,a,e),h.right=L(g,d,e+1,b),h}return null}function Q(g,d){for(var a=new w(null,null),b=a,c=0;c<g.length;c++)b=b.next=new w(g[c],d[c]);return b.next=null,a.next}function Ja(g){for(var d=g,a=[],b=!1,c=new w(null,null),e=c;!b;)d?(a.push(d),d=d.left):a.length>0?(d=e=e.next=a.pop(),d=d.right):b=!0;return e.next=null,c.next}function ca(g,d,a){var b=a-d;if(b>0){var c=d+Math.floor(b/2),e=ca(g,d,c),f=g.head;return f.left=e,g.head=g.head.next,f.right=ca(g,c+1,a),f}return null}function Ka(g,d,a){for(var b=new w(null,null),c=b,e=g,f=d;e!==null&&f!==null;)a(e.key,f.key)<0?(c.next=e,e=e.next):(c.next=f,f=f.next),c=c.next;return e!==null?c.next=e:f!==null&&(c.next=f),b.next}function da(g,d,a,b,c){if(a>=b)return;for(var e=g[a+b>>1],f=a-1,i=b+1;;){do f++;while(c(g[f],e)<0);do i--;while(c(g[i],e)>0);if(f>=i)break;var h=g[f];g[f]=g[i],g[i]=h,h=d[f],d[f]=d[i],d[i]=h}da(g,d,a,i,c),da(g,d,i+1,b,c)}var R=function g(d,a){return d.ll.x<=a.x&&a.x<=d.ur.x&&d.ll.y<=a.y&&a.y<=d.ur.y},ea=function g(d,a){if(a.ur.x<d.ll.x||d.ur.x<a.ll.x||a.ur.y<d.ll.y||d.ur.y<a.ll.y)return null;var b=d.ll.x<a.ll.x?a.ll.x:d.ll.x,c=d.ur.x<a.ur.x?d.ur.x:a.ur.x,e=d.ll.y<a.ll.y?a.ll.y:d.ll.y,f=d.ur.y<a.ur.y?d.ur.y:a.ur.y;return{ll:{x:b,y:e},ur:{x:c,y:f}}},J=Number.EPSILON;J===void 0&&(J=Math.pow(2,-52));var La=J*J,fa=function g(d,a){if(-J<d&&d<J){if(-J<a&&a<J)return 0}var b=d-a;return b*b<La*d*a?0:d<a?-1:1},Ma=function(){function g(){k(this,g),this.reset()}return s(g,[{key:"reset",value:function d(){this.xRounder=new pa(),this.yRounder=new pa()}},{key:"round",value:function d(a,b){return{x:this.xRounder.round(a),y:this.yRounder.round(b)}}}]),g}(),pa=function(){function g(){k(this,g),this.tree=new I(),this.round(0)}return s(g,[{key:"round",value:function d(a){var b=this.tree.add(a),c=this.tree.prev(b);if(c!==null&&fa(b.key,c.key)===0)return this.tree.remove(a),c.key;var e=this.tree.next(b);return e!==null&&fa(b.key,e.key)===0?(this.tree.remove(a),e.key):a}}]),g}(),S=new Ma(),T=function g(d,a){return d.x*a.y-d.y*a.x},qa=function g(d,a){return d.x*a.x+d.y*a.y},ra=function g(d,a,b){var c={x:a.x-d.x,y:a.y-d.y},e={x:b.x-d.x,y:b.y-d.y},f=T(c,e);return fa(f,0)},Z=function g(d){return Math.sqrt(qa(d,d))},Na=function g(d,a,b){var c={x:a.x-d.x,y:a.y-d.y},e={x:b.x-d.x,y:b.y-d.y};return T(e,c)/Z(e)/Z(c)},Oa=function g(d,a,b){var c={x:a.x-d.x,y:a.y-d.y},e={x:b.x-d.x,y:b.y-d.y};return qa(e,c)/Z(e)/Z(c)},sa=function g(d,a,b){return a.y===0?null:{x:d.x+a.x/a.y*(b-d.y),y:b}},ta=function g(d,a,b){return a.x===0?null:{x:b,y:d.y+a.y/a.x*(b-d.x)}},Pa=function g(d,a,b,c){if(a.x===0)return ta(b,c,d.x);if(c.x===0)return ta(d,a,b.x);if(a.y===0)return sa(b,c,d.y);if(c.y===0)return sa(d,a,b.y);var e=T(a,c);if(e==0)return null;var f={x:b.x-d.x,y:b.y-d.y},i=T(f,a)/e,h=T(f,c)/e,j=d.x+h*a.x,l=b.x+i*c.x,o=d.y+h*a.y,q=b.y+i*c.y,p=(j+l)/2,t=(o+q)/2;return{x:p,y:t}},F=function(){s(g,null,[{key:"compare",value:function d(a,b){var c=g.comparePoints(a.point,b.point);return c!==0?c:(a.point!==b.point&&a.link(b),a.isLeft!==b.isLeft?a.isLeft?1:-1:_.compare(a.segment,b.segment))}},{key:"comparePoints",value:function d(a,b){return a.x<b.x?-1:a.x>b.x?1:a.y<b.y?-1:a.y>b.y?1:0}}]);function g(d,a){k(this,g),d.events===void 0?d.events=[this]:d.events.push(this),this.point=d,this.isLeft=a}return s(g,[{key:"link",value:function d(a){if(a.point===this.point)throw new Error("Tried to link already linked events");for(var b=a.point.events,c=0,e=b.length;c<e;c++){var f=b[c];this.point.events.push(f),f.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function d(){for(var a=this.point.events.length,b=0;b<a;b++){var c=this.point.events[b];if(c.segment.consumedBy!==void 0)continue;for(var e=b+1;e<a;e++){var f=this.point.events[e];if(f.consumedBy!==void 0)continue;if(c.otherSE.point.events!==f.otherSE.point.events)continue;c.segment.consume(f.segment)}}}},{key:"getAvailableLinkedEvents",value:function d(){for(var a=[],b=0,c=this.point.events.length;b<c;b++){var e=this.point.events[b];e!==this&&!e.segment.ringOut&&e.segment.isInResult()&&a.push(e)}return a}},{key:"getLeftmostComparator",value:function d(a){var b=this,c=new Map(),e=function f(i){var h=i.otherSE;c.set(i,{sine:Na(b.point,a.point,h.point),cosine:Oa(b.point,a.point,h.point)})};return function(f,i){c.has(f)||e(f),c.has(i)||e(i);var h=c.get(f),j=h.sine,l=h.cosine,o=c.get(i),q=o.sine,p=o.cosine;return j>=0&&q>=0?l<p?1:l>p?-1:0:j<0&&q<0?l<p?-1:l>p?1:0:q<j?-1:q>j?1:0}}}]),g}(),Qa=0,_=function(){s(g,null,[{key:"compare",value:function d(a,b){var c=a.leftSE.point.x,e=b.leftSE.point.x,f=a.rightSE.point.x,i=b.rightSE.point.x;if(i<c)return 1;if(f<e)return-1;var h=a.leftSE.point.y,j=b.leftSE.point.y,l=a.rightSE.point.y,o=b.rightSE.point.y;if(c<e){if(j<h&&j<l)return 1;if(j>h&&j>l)return-1;var q=a.comparePoint(b.leftSE.point);if(q<0)return 1;if(q>0)return-1;var p=b.comparePoint(a.rightSE.point);return p!==0?p:-1}if(c>e){if(h<j&&h<o)return-1;if(h>j&&h>o)return 1;var t=b.comparePoint(a.leftSE.point);if(t!==0)return t;var r=a.comparePoint(b.rightSE.point);return r<0?1:r>0?-1:1}if(h<j)return-1;if(h>j)return 1;if(f<i){var u=b.comparePoint(a.rightSE.point);if(u!==0)return u}if(f>i){var z=a.comparePoint(b.rightSE.point);if(z<0)return 1;if(z>0)return-1}if(f!==i){var A=l-h,C=f-c,y=o-j,G=i-e;if(A>C&&y<G)return 1;if(A<C&&y>G)return-1}return f>i?1:f<i?-1:l<o?-1:l>o?1:a.id<b.id?-1:a.id>b.id?1:0}}]);function g(d,a,b,c){k(this,g),this.id=++Qa,this.leftSE=d,d.segment=this,d.otherSE=a,this.rightSE=a,a.segment=this,a.otherSE=d,this.rings=b,this.windings=c}return s(g,[{key:"replaceRightSE",value:function d(a){this.rightSE=a,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function d(){var a=this.leftSE.point.y,b=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:a<b?a:b},ur:{x:this.rightSE.point.x,y:a>b?a:b}}}},{key:"vector",value:function d(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function d(a){return a.x===this.leftSE.point.x&&a.y===this.leftSE.point.y||a.x===this.rightSE.point.x&&a.y===this.rightSE.point.y}},{key:"comparePoint",value:function d(a){if(this.isAnEndpoint(a))return 0;var b=this.leftSE.point,c=this.rightSE.point,e=this.vector();if(b.x===c.x)return a.x===b.x?0:a.x<b.x?1:-1;var f=(a.y-b.y)/e.y,i=b.x+f*e.x;if(a.x===i)return 0;var h=(a.x-b.x)/e.x,j=b.y+h*e.y;return a.y===j?0:a.y<j?-1:1}},{key:"getIntersection",value:function d(a){var b=this.bbox(),c=a.bbox(),e=ea(b,c);if(e===null)return null;var f=this.leftSE.point,i=this.rightSE.point,h=a.leftSE.point,j=a.rightSE.point,l=R(b,h)&&this.comparePoint(h)===0,o=R(c,f)&&a.comparePoint(f)===0,q=R(b,j)&&this.comparePoint(j)===0,p=R(c,i)&&a.comparePoint(i)===0;if(o&&l)return p&&!q?i:!p&&q?j:null;if(o){if(q){if(f.x===j.x&&f.y===j.y)return null}return f}if(l){if(p){if(i.x===h.x&&i.y===h.y)return null}return h}if(p&&q)return null;if(p)return i;if(q)return j;var t=Pa(f,this.vector(),h,a.vector());return t===null?null:R(e,t)?S.round(t.x,t.y):null}},{key:"split",value:function d(a){var b=[],c=a.events!==void 0,e=new F(a,!0),f=new F(a,!1),i=this.rightSE;this.replaceRightSE(f),b.push(f),b.push(e);var h=new g(e,i,this.rings.slice(),this.windings.slice());return F.comparePoints(h.leftSE.point,h.rightSE.point)>0&&h.swapEvents(),F.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),c&&(e.checkForConsuming(),f.checkForConsuming()),b}},{key:"swapEvents",value:function d(){var a=this.rightSE;this.rightSE=this.leftSE,this.leftSE=a,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var b=0,c=this.windings.length;b<c;b++)this.windings[b]*=-1}},{key:"consume",value:function d(a){for(var b=this,c=a;b.consumedBy;)b=b.consumedBy;for(;c.consumedBy;)c=c.consumedBy;var e=g.compare(b,c);if(e===0)return;if(e>0){var f=b;b=c,c=f}if(b.prev===c){var i=b;b=c,c=i}for(var h=0,j=c.rings.length;h<j;h++){var l=c.rings[h],o=c.windings[h],q=b.rings.indexOf(l);q===-1?(b.rings.push(l),b.windings.push(o)):b.windings[q]+=o}c.rings=null,c.windings=null,c.consumedBy=b,c.leftSE.consumedBy=b.leftSE,c.rightSE.consumedBy=b.rightSE}},{key:"prevInResult",value:function d(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function d(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var a=this.prev.consumedBy||this.prev;this._beforeState=a.afterState()}return this._beforeState}},{key:"afterState",value:function d(){if(this._afterState!==void 0)return this._afterState;var a=this.beforeState();this._afterState={rings:a.rings.slice(0),windings:a.windings.slice(0),multiPolys:[]};for(var b=this._afterState.rings,c=this._afterState.windings,e=this._afterState.multiPolys,f=0,i=this.rings.length;f<i;f++){var h=this.rings[f],j=this.windings[f],l=b.indexOf(h);l===-1?(b.push(h),c.push(j)):c[l]+=j}for(var o=[],q=[],p=0,t=b.length;p<t;p++){if(c[p]===0)continue;var r=b[p],u=r.poly;if(q.indexOf(u)!==-1)continue;if(r.isExterior)o.push(u);else{q.indexOf(u)===-1&&q.push(u);var z=o.indexOf(r.poly);z!==-1&&o.splice(z,1)}}for(var A=0,C=o.length;A<C;A++){var y=o[A].multiPoly;e.indexOf(y)===-1&&e.push(y)}return this._afterState}},{key:"isInResult",value:function d(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var a=this.beforeState().multiPolys,b=this.afterState().multiPolys;switch(D.type){case"union":{var c=a.length===0,e=b.length===0;this._isInResult=c!==e;break}case"intersection":{var f,i;a.length<b.length?(f=a.length,i=b.length):(f=b.length,i=a.length),this._isInResult=i===D.numMultiPolys&&f<i;break}case"xor":{var h=Math.abs(a.length-b.length);this._isInResult=h%2===1;break}case"difference":{var j=function l(o){return o.length===1&&o[0].isSubject};this._isInResult=j(a)!==j(b);break}default:throw new Error("Unrecognized operation type found ".concat(D.type))}return this._isInResult}}],[{key:"fromRing",value:function d(a,b,c){var e,f,i,h=F.comparePoints(a,b);if(h<0)e=a,f=b,i=1;else if(h>0)e=b,f=a,i=-1;else throw new Error("Tried to create degenerate segment at [".concat(a.x,", ").concat(a.y,"]"));var j=new F(e,!0),l=new F(f,!1);return new g(j,l,[c],[i])}}]),g}(),ua=function(){function g(d,a,b){k(this,g);if(!Array.isArray(d)||d.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.poly=a,this.isExterior=b,this.segments=[];if(typeof d[0][0]!=="number"||typeof d[0][1]!=="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var c=S.round(d[0][0],d[0][1]);this.bbox={ll:{x:c.x,y:c.y},ur:{x:c.x,y:c.y}};for(var e=c,f=1,i=d.length;f<i;f++){if(typeof d[f][0]!=="number"||typeof d[f][1]!=="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var h=S.round(d[f][0],d[f][1]);if(h.x===e.x&&h.y===e.y)continue;this.segments.push(_.fromRing(e,h,this)),h.x<this.bbox.ll.x&&(this.bbox.ll.x=h.x),h.y<this.bbox.ll.y&&(this.bbox.ll.y=h.y),h.x>this.bbox.ur.x&&(this.bbox.ur.x=h.x),h.y>this.bbox.ur.y&&(this.bbox.ur.y=h.y),e=h}(c.x!==e.x||c.y!==e.y)&&this.segments.push(_.fromRing(e,c,this))}return s(g,[{key:"getSweepEvents",value:function d(){for(var a=[],b=0,c=this.segments.length;b<c;b++){var e=this.segments[b];a.push(e.leftSE),a.push(e.rightSE)}return a}}]),g}(),Ra=function(){function g(d,a){k(this,g);if(!Array.isArray(d))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new ua(d[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var b=1,c=d.length;b<c;b++){var e=new ua(d[b],this,!1);e.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=e.bbox.ll.x),e.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=e.bbox.ll.y),e.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=e.bbox.ur.x),e.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=e.bbox.ur.y),this.interiorRings.push(e)}this.multiPoly=a}return s(g,[{key:"getSweepEvents",value:function d(){for(var a=this.exteriorRing.getSweepEvents(),b=0,c=this.interiorRings.length;b<c;b++)for(var e=this.interiorRings[b].getSweepEvents(),f=0,i=e.length;f<i;f++)a.push(e[f]);return a}}]),g}(),va=function(){function g(d,a){k(this,g);if(!Array.isArray(d))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof d[0][0][0]==="number"&&(d=[d])}catch(f){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var b=0,c=d.length;b<c;b++){var e=new Ra(d[b],this);e.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=e.bbox.ll.x),e.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=e.bbox.ll.y),e.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=e.bbox.ur.x),e.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=e.bbox.ur.y),this.polys.push(e)}this.isSubject=a}return s(g,[{key:"getSweepEvents",value:function d(){for(var a=[],b=0,c=this.polys.length;b<c;b++)for(var e=this.polys[b].getSweepEvents(),f=0,i=e.length;f<i;f++)a.push(e[f]);return a}}]),g}(),Sa=function(){s(g,null,[{key:"factory",value:function d(a){for(var b=[],c=0,e=a.length;c<e;c++){var f=a[c];if(!f.isInResult()||f.ringOut)continue;for(var i=null,h=f.leftSE,j=f.rightSE,l=[h],o=h.point,q=[];;){i=h,h=j,l.push(h);if(h.point===o)break;for(;;){var p=h.getAvailableLinkedEvents();if(p.length===0){var t=l[0].point,r=l[l.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(t.x,",")+" ".concat(t.y,"]. Last matching segment found ends at")+" [".concat(r.x,", ").concat(r.y,"]."))}if(p.length===1){j=p[0].otherSE;break}for(var u=null,z=0,A=q.length;z<A;z++)if(q[z].point===h.point){u=z;break}if(u!==null){var C=q.splice(u)[0],y=l.splice(C.index);y.unshift(y[0].otherSE),b.push(new g(y.reverse()));continue}q.push({index:l.length,point:h.point});var G=h.getLeftmostComparator(i);j=p.sort(G)[0].otherSE;break}}b.push(new g(l))}return b}}]);function g(d){k(this,g),this.events=d;for(var a=0,b=d.length;a<b;a++)d[a].segment.ringOut=this;this.poly=null}return s(g,[{key:"getGeom",value:function d(){for(var a=this.events[0].point,b=[a],c=1,e=this.events.length-1;c<e;c++){var f=this.events[c].point,i=this.events[c+1].point;if(ra(f,a,i)===0)continue;b.push(f),a=f}if(b.length===1)return null;var h=b[0],j=b[1];ra(h,a,j)===0&&b.shift(),b.push(b[0]);for(var l=this.isExteriorRing()?1:-1,o=this.isExteriorRing()?0:b.length-1,q=this.isExteriorRing()?b.length:-1,p=[],t=o;t!=q;t+=l)p.push([b[t].x,b[t].y]);return p}},{key:"isExteriorRing",value:function d(){if(this._isExteriorRing===void 0){var a=this.enclosingRing();this._isExteriorRing=a?!a.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function d(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function d(){for(var a=this.events[0],b=1,c=this.events.length;b<c;b++){var e=this.events[b];F.compare(a,e)>0&&(a=e)}for(var f=a.segment.prevInResult(),i=f?f.prevInResult():null;;){if(!f)return null;if(!i)return f.ringOut;if(i.ringOut!==f.ringOut)return i.ringOut.enclosingRing()!==f.ringOut?f.ringOut:f.ringOut.enclosingRing();f=i.prevInResult(),i=f?f.prevInResult():null}}}]),g}(),wa=function(){function g(d){k(this,g),this.exteriorRing=d,d.poly=this,this.interiorRings=[]}return s(g,[{key:"addInterior",value:function d(a){this.interiorRings.push(a),a.poly=this}},{key:"getGeom",value:function d(){var a=[this.exteriorRing.getGeom()];if(a[0]===null)return null;for(var b=0,c=this.interiorRings.length;b<c;b++){var e=this.interiorRings[b].getGeom();if(e===null)continue;a.push(e)}return a}}]),g}(),Ta=function(){function g(d){k(this,g),this.rings=d,this.polys=this._composePolys(d)}return s(g,[{key:"getGeom",value:function d(){for(var a=[],b=0,c=this.polys.length;b<c;b++){var e=this.polys[b].getGeom();if(e===null)continue;a.push(e)}return a}},{key:"_composePolys",value:function d(a){for(var b=[],c=0,e=a.length;c<e;c++){var f=a[c];if(f.poly)continue;if(f.isExteriorRing())b.push(new wa(f));else{var i=f.enclosingRing();i.poly||b.push(new wa(i)),i.poly.addInterior(f)}}return b}}]),g}(),Ua=function(){function g(d){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.compare;k(this,g),this.queue=d,this.tree=new I(a),this.segments=[]}return s(g,[{key:"process",value:function d(a){var b=a.segment,c=[];if(a.consumedBy)return a.isLeft?this.queue.remove(a.otherSE):this.tree.remove(b),c;var e=a.isLeft?this.tree.insert(b):this.tree.find(b);if(!e)throw new Error("Unable to find segment #".concat(b.id," ")+"[".concat(b.leftSE.point.x,", ").concat(b.leftSE.point.y,"] -> ")+"[".concat(b.rightSE.point.x,", ").concat(b.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var f=e,i=e,h=void 0,j=void 0;h===void 0;)f=this.tree.prev(f),f===null?h=null:f.key.consumedBy===void 0&&(h=f.key);for(;j===void 0;)i=this.tree.next(i),i===null?j=null:i.key.consumedBy===void 0&&(j=i.key);if(a.isLeft){var l=null;if(h){var o=h.getIntersection(b);if(o!==null){b.isAnEndpoint(o)||(l=o);if(!h.isAnEndpoint(o))for(var q=this._splitSafely(h,o),p=0,t=q.length;p<t;p++)c.push(q[p])}}var r=null;if(j){var u=j.getIntersection(b);if(u!==null){b.isAnEndpoint(u)||(r=u);if(!j.isAnEndpoint(u))for(var z=this._splitSafely(j,u),A=0,C=z.length;A<C;A++)c.push(z[A])}}if(l!==null||r!==null){var y=null;if(l===null)y=r;else if(r===null)y=l;else{var G=F.comparePoints(l,r);y=G<=0?l:r}this.queue.remove(b.rightSE),c.push(b.rightSE);for(var U=b.split(y),M=0,N=U.length;M<N;M++)c.push(U[M])}c.length>0?(this.tree.remove(b),c.push(a)):(this.segments.push(b),b.prev=h)}else{if(h&&j){var E=h.getIntersection(j);if(E!==null){if(!h.isAnEndpoint(E))for(var V=this._splitSafely(h,E),O=0,ga=V.length;O<ga;O++)c.push(V[O]);if(!j.isAnEndpoint(E))for(var W=this._splitSafely(j,E),X=0,ha=W.length;X<ha;X++)c.push(W[X])}}this.tree.remove(b)}return c}},{key:"_splitSafely",value:function d(a,b){this.tree.remove(a);var c=a.rightSE;this.queue.remove(c);var e=a.split(b);return e.push(c),a.consumedBy===void 0&&this.tree.insert(a),e}}]),g}(),xa=typeof process!=="undefined"&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Va=typeof process!=="undefined"&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,Wa=function(){function g(){k(this,g)}return s(g,[{key:"run",value:function d(a,b,c){D.type=a,S.reset();for(var e=[new va(b,!0)],f=0,i=c.length;f<i;f++)e.push(new va(c[f],!1));D.numMultiPolys=e.length;if(D.type==="difference")for(var h=e[0],j=1;j<e.length;)ea(e[j].bbox,h.bbox)!==null?j++:e.splice(j,1);if(D.type==="intersection"){for(var l=0,o=e.length;l<o;l++)for(var q=e[l],p=l+1,t=e.length;p<t;p++)if(ea(q.bbox,e[p].bbox)===null)return[]}for(var r=new I(F.compare),u=0,z=e.length;u<z;u++)for(var A=e[u].getSweepEvents(),C=0,y=A.length;C<y;C++){r.insert(A[C]);if(r.size>xa)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.")}for(var G=new Ua(r),U=r.size,M=r.pop();M;){var N=M.key;if(r.size===U){var E=N.segment;throw new Error("Unable to pop() ".concat(N.isLeft?"left":"right"," SweepEvent ")+"[".concat(N.point.x,", ").concat(N.point.y,"] from segment #").concat(E.id," ")+"[".concat(E.leftSE.point.x,", ").concat(E.leftSE.point.y,"] -> ")+"[".concat(E.rightSE.point.x,", ").concat(E.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(r.size>xa)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(G.segments.length>Va)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var V=G.process(N),O=0,ga=V.length;O<ga;O++){var W=V[O];W.consumedBy===void 0&&r.insert(W)}U=r.size,M=r.pop()}S.reset();var X=Sa.factory(G.segments),ha=new Ta(X);return ha.getGeom()}}]),g}(),D=new Wa(),Xa=function g(d){for(var a=arguments.length,b=new Array(a>1?a-1:0),c=1;c<a;c++)b[c-1]=arguments[c];return D.run("union",d,b)},Ya=function g(d){for(var a=arguments.length,b=new Array(a>1?a-1:0),c=1;c<a;c++)b[c-1]=arguments[c];return D.run("intersection",d,b)},Za=function g(d){for(var a=arguments.length,b=new Array(a>1?a-1:0),c=1;c<a;c++)b[c-1]=arguments[c];return D.run("xor",d,b)},_a=function g(d){for(var a=arguments.length,b=new Array(a>1?a-1:0),c=1;c<a;c++)b[c-1]=arguments[c];return D.run("difference",d,b)},$a={union:Xa,intersection:Ya,xor:Za,difference:_a};return $a})});const ab=Ia(ia()),za=!0,ja=.2,ka=.2,la=3,Aa="#FFCC00",Ba="#CCFF00",Ca="#00CCFF";function ma(m,n){let k=Math.min(window.innerWidth,window.innerHeight);za||(k=m.width),m.width=k,m.height=k,n.setTransform(k,0,0,k,0,0)}function na(m,n,k,v){let s=1-2*v,w=s/(n*(k+1)),K=k*w,B=2*v,x=w*3**.5/2,P=(1-(x+w*k)*3)/2,Y=new Array(n*n);for(let H=0;H<n;H++)for(let I=0;I<n;I++){let L=v+m[0]*B+H*(K+w),Q=P+m[1]*B+I*(K+x);Y[H*n+I]=[[L,Q+x],[L+w/2,Q],[L+w,Q+x]]}return Y}function Da(m,n){return ab.intersection([m],n.map(k=>[k])).map(k=>k[0])}function $(m,n,k){m.beginPath(),m.moveTo(n[0][0],n[0][1]);for(var v of n.slice(1))m.lineTo(v[0],v[1]);m.fillStyle=k,m.fill(),m.closePath()}function aa(m,n){let k=m.canvas,v=n[0],s=n[1],w=na(n,la,ja,ka),K=na([v/2,s/2],la,ja,ka),B=w.map(x=>Da(x,K)).reduce((x,P)=>x.concat(P));m.clearRect(0,0,k.width,k.height);for(let x of w)$(m,x,Aa);for(let x of K)$(m,x,Ba);for(let x of B)$(m,x,Ca)}function Ea(){let m=document.querySelectorAll("canvas")[0],n=m.getContext("2d");ma(m,n),aa(n,[0,0]);let k=0,v=0;window.addEventListener("mousemove",function(s){var w=[];k=-(s.clientX/window.innerWidth-.5),v=-(s.clientY/window.innerHeight-.5),requestAnimationFrame(()=>{aa(n,[k,v])})}),window.addEventListener("resize",()=>{ma(m,n),requestAnimationFrame(()=>{aa(n,[k,v])})})}Ea();})();
/**
 * splaytree v3.0.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */
